{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-20T19:35:45.625626Z", "invocation_id": "9d1e2902-b1ac-4c97-bae8-b91a638afc13", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.402529Z", "completed_at": "2025-05-20T19:35:45.424658Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.424658Z", "completed_at": "2025-05-20T19:35:45.424658Z"}], "thread_id": "Thread-1", "execution_time": 0.022129297256469727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.stg_esg_risk", "compiled": true, "compiled_code": "\n\nSELECT\n    \"country\",\n    \"country_name\",\n    \"indicator\",\n    \"indicator_name\",\n    TRY_CAST(\"year\" AS INT) AS year,\n    TRY_CAST(\"value\" AS FLOAT) AS value,\n    TRY_CAST(\"gdp\" AS FLOAT) AS gdp,\n    TRY_CAST(\"population\" AS FLOAT) AS population\nFROM BANK_DATA.RAW_DATA.bank_esg_risk\nWHERE \"value\" IS NOT NULL", "relation_name": "BANK_DATA.ANALYTICS.stg_esg_risk", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.424658Z", "completed_at": "2025-05-20T19:35:45.440315Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.440315Z", "completed_at": "2025-05-20T19:35:45.440315Z"}], "thread_id": "Thread-3", "execution_time": 0.015656232833862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.dim_country_stats", "compiled": true, "compiled_code": "-- models/dim_country_stats.sql\n\n\n\nSELECT\n    country,\n    country_name,\n    COUNT(DISTINCT indicator_name) AS num_indicators,\n    COUNT(DISTINCT year) AS num_years,\n    AVG(value) AS avg_value,\n    MIN(value) AS min_value,\n    MAX(value) AS max_value\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nGROUP BY country, country_name", "relation_name": "BANK_DATA.ANALYTICS.dim_country_stats", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.424658Z", "completed_at": "2025-05-20T19:35:45.440315Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.440315Z", "completed_at": "2025-05-20T19:35:45.440315Z"}], "thread_id": "Thread-4", "execution_time": 0.015656232833862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.esg_heatmap_matrix", "compiled": true, "compiled_code": "-- models/esg_heatmap_matrix.sql\n\n\n\nSELECT\n    country_name,\n    indicator_name,\n    AVG(value) AS avg_esg\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nGROUP BY country_name, indicator_name", "relation_name": "BANK_DATA.ANALYTICS.esg_heatmap_matrix", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.424658Z", "completed_at": "2025-05-20T19:35:45.440315Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.440315Z", "completed_at": "2025-05-20T19:35:45.440315Z"}], "thread_id": "Thread-2", "execution_time": 0.015656232833862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.esg_improvement_trends", "compiled": true, "compiled_code": "-- models/esg_improvement_trends.sql\n\n\n\nWITH first_values AS (\n    SELECT\n        country_name,\n        indicator_name,\n        MIN(year) AS first_year\n    FROM BANK_DATA.ANALYTICS.stg_esg_risk\n    GROUP BY country_name, indicator_name\n),\nlast_values AS (\n    SELECT\n        country_name,\n        indicator_name,\n        MAX(year) AS last_year\n    FROM BANK_DATA.ANALYTICS.stg_esg_risk\n    GROUP BY country_name, indicator_name\n),\nfirst_data AS (\n    SELECT a.country_name, a.indicator_name, s.value AS first_value\n    FROM first_values a\n    JOIN BANK_DATA.ANALYTICS.stg_esg_risk s\n      ON a.country_name = s.country_name AND a.indicator_name = s.indicator_name AND a.first_year = s.year\n),\nlast_data AS (\n    SELECT a.country_name, a.indicator_name, s.value AS last_value\n    FROM last_values a\n    JOIN BANK_DATA.ANALYTICS.stg_esg_risk s\n      ON a.country_name = s.country_name AND a.indicator_name = s.indicator_name AND a.last_year = s.year\n)\nSELECT\n    f.country_name,\n    f.indicator_name,\n    l.last_value - f.first_value AS improvement\nFROM first_data f\nJOIN last_data l\n  ON f.country_name = l.country_name AND f.indicator_name = l.indicator_name\nORDER BY improvement DESC", "relation_name": "BANK_DATA.ANALYTICS.esg_improvement_trends", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.440315Z", "completed_at": "2025-05-20T19:35:45.440315Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.440315Z", "completed_at": "2025-05-20T19:35:45.440315Z"}], "thread_id": "Thread-1", "execution_time": 0.015656232833862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.esg_per_capita", "compiled": true, "compiled_code": "-- models/esg_per_capita.sql\n\n\n\nSELECT\n    country_name,\n    SUM(value) / AVG(population) AS esg_per_capita\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nWHERE population IS NOT NULL\nGROUP BY country_name", "relation_name": "BANK_DATA.ANALYTICS.esg_per_capita", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.440315Z", "completed_at": "2025-05-20T19:35:45.455921Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.455921Z", "completed_at": "2025-05-20T19:35:45.455921Z"}], "thread_id": "Thread-3", "execution_time": 0.01560664176940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.esg_vs_gdp", "compiled": true, "compiled_code": "-- models/esg_vs_gdp.sql\n\n\n\nSELECT\n    country_name,\n    indicator_name,\n    AVG(value) AS avg_esg,\n    AVG(gdp) AS avg_gdp\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nWHERE gdp IS NOT NULL\nGROUP BY country_name, indicator_name", "relation_name": "BANK_DATA.ANALYTICS.esg_vs_gdp", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.455921Z", "completed_at": "2025-05-20T19:35:45.455921Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.455921Z", "completed_at": "2025-05-20T19:35:45.455921Z"}], "thread_id": "Thread-2", "execution_time": 0.01560664176940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.gdp_esg_correlation", "compiled": true, "compiled_code": "-- models/gdp_esg_correlation.sql\n\n\n\nSELECT\n    indicator_name,\n    CORR(value, gdp) AS gdp_esg_correlation\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nWHERE gdp IS NOT NULL\nGROUP BY indicator_name\nORDER BY ABS(gdp_esg_correlation) DESC", "relation_name": "BANK_DATA.ANALYTICS.gdp_esg_correlation", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.455921Z", "completed_at": "2025-05-20T19:35:45.455921Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.455921Z", "completed_at": "2025-05-20T19:35:45.455921Z"}], "thread_id": "Thread-4", "execution_time": 0.01560664176940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.fct_esg_summary", "compiled": true, "compiled_code": "-- models/fct_esg_summary.sql\n\n\n\nSELECT\n    country,\n    year,\n    indicator_name,\n    AVG(value) AS avg_value\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nGROUP BY country, year, indicator_name", "relation_name": "BANK_DATA.ANALYTICS.fct_esg_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.455921Z", "completed_at": "2025-05-20T19:35:45.455921Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.455921Z", "completed_at": "2025-05-20T19:35:45.455921Z"}], "thread_id": "Thread-1", "execution_time": 0.01560664176940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.indicator_volatility", "compiled": true, "compiled_code": "-- models/indicator_volatility.sql\n\n\n\nSELECT\n    indicator_name,\n    STDDEV(value) AS volatility\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nGROUP BY indicator_name\nORDER BY volatility DESC", "relation_name": "BANK_DATA.ANALYTICS.indicator_volatility", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.471544Z", "completed_at": "2025-05-20T19:35:45.471544Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.471544Z", "completed_at": "2025-05-20T19:35:45.471544Z"}], "thread_id": "Thread-3", "execution_time": 0.015623092651367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.outlier_detection", "compiled": true, "compiled_code": "-- models/outlier_detection.sql\n\n\n\nWITH stats AS (\n    SELECT\n        indicator_name,\n        AVG(value) AS mean_val,\n        STDDEV(value) AS std_val\n    FROM BANK_DATA.ANALYTICS.stg_esg_risk\n    GROUP BY indicator_name\n)\nSELECT\n    s.country_name,\n    s.indicator_name,\n    s.year,\n    s.value,\n    (s.value - st.mean_val) / st.std_val AS z_score\nFROM BANK_DATA.ANALYTICS.stg_esg_risk s\nJOIN stats st\n  ON s.indicator_name = st.indicator_name\nWHERE ABS((s.value - st.mean_val) / st.std_val) > 2", "relation_name": "BANK_DATA.ANALYTICS.outlier_detection", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.471544Z", "completed_at": "2025-05-20T19:35:45.471544Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.471544Z", "completed_at": "2025-05-20T19:35:45.471544Z"}], "thread_id": "Thread-2", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.resilience_index", "compiled": true, "compiled_code": "-- models/resilience_index.sql\n\n\n\nSELECT\n    country_name,\n    AVG(value) / NULLIF(AVG(gdp), 0) AS resilience_index\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nWHERE gdp IS NOT NULL\nGROUP BY country_name\nORDER BY resilience_index DESC", "relation_name": "BANK_DATA.ANALYTICS.resilience_index", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T19:35:45.471544Z", "completed_at": "2025-05-20T19:35:45.471544Z"}, {"name": "execute", "started_at": "2025-05-20T19:35:45.471544Z", "completed_at": "2025-05-20T19:35:45.471544Z"}], "thread_id": "Thread-4", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_analytics.top_esg_countries", "compiled": true, "compiled_code": "-- models/top_esg_countries.sql\n\n\n\nWITH ranked AS (\n    SELECT\n        country_name,\n        AVG(value) AS avg_esg\n    FROM BANK_DATA.ANALYTICS.stg_esg_risk\n    GROUP BY country_name\n)\nSELECT *\nFROM ranked\nORDER BY avg_esg DESC\nLIMIT 10", "relation_name": "BANK_DATA.ANALYTICS.top_esg_countries", "batch_results": null}], "elapsed_time": 1.288639783859253, "args": {"skip_nodes_if_on_run_start_fails": false, "print": true, "strict_mode": false, "introspect": true, "use_colors_file": true, "output": "text", "log_format": "default", "inject_ephemeral_ctes": true, "require_yaml_configuration_for_mf_time_spines": false, "log_level_file": "debug", "partial_parse": true, "require_batched_execution_for_custom_microbatch_strategy": false, "static_parser": true, "log_level": "info", "empty": false, "state_modified_compare_vars": false, "vars": {}, "select": [], "exclude": [], "version_check": true, "require_resource_names_without_spaces": false, "log_path": "C:\\Projects\\DBT\\bank-analytics\\-ESG-Risk-Intelligence-Platform\\dbt\\logs", "profiles_dir": "C:\\Users\\riber\\.dbt", "show_resource_report": false, "which": "compile", "state_modified_compare_more_unrendered_values": false, "invocation_command": "dbt compile", "require_explicit_package_overrides_for_builtin_materializations": true, "log_file_max_bytes": 10485760, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "C:\\Projects\\DBT\\bank-analytics\\-ESG-Risk-Intelligence-Platform\\dbt", "source_freshness_run_project_hooks": false, "log_format_file": "debug", "quiet": false, "macro_debugging": false, "require_nested_cumulative_type_params": false, "populate_cache": true, "write_json": true, "printer_width": 80, "send_anonymous_usage_stats": true, "defer": false, "favor_state": false, "partial_parse_file_diff": true, "indirect_selection": "eager", "cache_selected_only": false}}
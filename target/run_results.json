{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-20T20:41:47.831248Z", "invocation_id": "23619c58-1a90-4077-aab7-da76f809bdd4", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T20:41:45.927002Z", "completed_at": "2025-05-20T20:41:45.938001Z"}, {"name": "execute", "started_at": "2025-05-20T20:41:45.939000Z", "completed_at": "2025-05-20T20:41:46.537550Z"}], "thread_id": "Thread-1", "execution_time": 0.6115491390228271, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc7b59-0104-8c68-0003-767e0001c18a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bank_analytics.stg_esg_risk", "compiled": true, "compiled_code": "\nSELECT * FROM RAW_DATA.BANK_ESG_RISK", "relation_name": "BANK_DATA.ANALYTICS.stg_esg_risk", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T20:41:46.559549Z", "completed_at": "2025-05-20T20:41:46.566575Z"}, {"name": "execute", "started_at": "2025-05-20T20:41:46.572565Z", "completed_at": "2025-05-20T20:41:46.882807Z"}], "thread_id": "Thread-1", "execution_time": 0.33325839042663574, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc7b59-0104-8c17-0003-767e0002118a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bank_analytics.esg_resilience_window", "compiled": true, "compiled_code": "\nWITH ranked AS (\n    SELECT\n        \"country_name\",\n        \"indicator_name\",\n        \"year\",\n        \"value\",\n        STDDEV(\"value\") OVER (PARTITION BY \"country_name\", \"indicator_name\" ORDER BY \"year\" ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS rolling_std\n    FROM BANK_DATA.ANALYTICS.stg_esg_risk\n    WHERE \"value\" IS NOT NULL\n)\nSELECT * FROM ranked WHERE rolling_std IS NOT NULL", "relation_name": "BANK_DATA.ANALYTICS.esg_resilience_window", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T20:41:46.550560Z", "completed_at": "2025-05-20T20:41:46.561568Z"}, {"name": "execute", "started_at": "2025-05-20T20:41:46.564551Z", "completed_at": "2025-05-20T20:41:47.050737Z"}], "thread_id": "Thread-3", "execution_time": 0.5061874389648438, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc7b59-0104-8d73-0003-767e0002019a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bank_analytics.avg_esg_per_country", "compiled": true, "compiled_code": "\nSELECT\n    \"country_name\",\n    AVG(\"value\") AS avg_esg_score\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nWHERE \"value\" IS NOT NULL\nGROUP BY \"country_name\"\nORDER BY avg_esg_score DESC", "relation_name": "BANK_DATA.ANALYTICS.avg_esg_per_country", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T20:41:46.553566Z", "completed_at": "2025-05-20T20:41:46.563550Z"}, {"name": "execute", "started_at": "2025-05-20T20:41:46.567549Z", "completed_at": "2025-05-20T20:41:47.073920Z"}], "thread_id": "Thread-4", "execution_time": 0.5273704528808594, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc7b59-0104-8d73-0003-767e0002019e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bank_analytics.esg_category_aggregation", "compiled": true, "compiled_code": "\nSELECT\n    \"country_name\",\n    \"year\",\n    CASE\n        WHEN LOWER(\"indicator_name\") LIKE '%environment%' THEN 'Environmental'\n        WHEN LOWER(\"indicator_name\") LIKE '%social%' THEN 'Social'\n        WHEN LOWER(\"indicator_name\") LIKE '%governance%' THEN 'Governance'\n        ELSE 'Other'\n    END AS esg_category,\n    AVG(\"value\") AS avg_score\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nWHERE \"value\" IS NOT NULL\nGROUP BY \"country_name\", \"year\", esg_category", "relation_name": "BANK_DATA.ANALYTICS.esg_category_aggregation", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T20:41:46.886807Z", "completed_at": "2025-05-20T20:41:46.889807Z"}, {"name": "execute", "started_at": "2025-05-20T20:41:46.889807Z", "completed_at": "2025-05-20T20:41:47.076312Z"}], "thread_id": "Thread-1", "execution_time": 0.19050312042236328, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc7b59-0104-8c68-0003-767e0001c18e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bank_analytics.esg_vs_population", "compiled": true, "compiled_code": "\nSELECT\n    \"country\",\n    \"country_name\",\n    \"year\",\n    \"value\" / NULLIF(\"population\", 0) AS esg_per_capita\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nWHERE \"value\" IS NOT NULL AND \"population\" IS NOT NULL\nORDER BY esg_per_capita DESC", "relation_name": "BANK_DATA.ANALYTICS.esg_vs_population", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T20:41:46.556549Z", "completed_at": "2025-05-20T20:41:46.563550Z"}, {"name": "execute", "started_at": "2025-05-20T20:41:46.569575Z", "completed_at": "2025-05-20T20:41:47.078309Z"}], "thread_id": "Thread-2", "execution_time": 0.5307583808898926, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc7b59-0104-8c68-0003-767e0001c192"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bank_analytics.esg_indicator_trend", "compiled": true, "compiled_code": "\nSELECT\n    \"country_name\",\n    \"indicator_name\",\n    \"year\",\n    \"value\",\n    \"value\" - LAG(\"value\") OVER (PARTITION BY \"country_name\", \"indicator_name\" ORDER BY \"year\") AS year_over_year_change\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nWHERE \"value\" IS NOT NULL", "relation_name": "BANK_DATA.ANALYTICS.esg_indicator_trend", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T20:41:47.056740Z", "completed_at": "2025-05-20T20:41:47.061740Z"}, {"name": "execute", "started_at": "2025-05-20T20:41:47.061740Z", "completed_at": "2025-05-20T20:41:47.276689Z"}], "thread_id": "Thread-3", "execution_time": 0.22095036506652832, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc7b59-0104-8c17-0003-767e0002118e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bank_analytics.top_gdp_weighted_esg", "compiled": true, "compiled_code": "\nSELECT\n    \"country\",\n    \"country_name\",\n    \"year\",\n    SUM(\"value\" * \"gdp\") / SUM(\"gdp\") AS gdp_weighted_esg\nFROM BANK_DATA.ANALYTICS.stg_esg_risk\nWHERE \"gdp\" IS NOT NULL AND \"value\" IS NOT NULL\nGROUP BY \"country\", \"country_name\", \"year\"\nORDER BY gdp_weighted_esg DESC", "relation_name": "BANK_DATA.ANALYTICS.top_gdp_weighted_esg", "batch_results": null}], "elapsed_time": 3.095130443572998, "args": {"log_format_file": "debug", "print": true, "profiles_dir": "C:\\Users\\riber\\.dbt", "skip_nodes_if_on_run_start_fails": false, "partial_parse_file_diff": true, "exclude": [], "state_modified_compare_vars": false, "use_colors_file": true, "which": "run", "invocation_command": "dbt run", "state_modified_compare_more_unrendered_values": false, "log_level": "info", "defer": false, "write_json": true, "cache_selected_only": false, "log_level_file": "debug", "printer_width": 80, "require_yaml_configuration_for_mf_time_spines": false, "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "require_resource_names_without_spaces": false, "log_format": "default", "log_path": "C:\\Projects\\DBT\\bank-analytics\\-ESG-Risk-Intelligence-Platform\\logs", "favor_state": false, "empty": false, "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "source_freshness_run_project_hooks": false, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "strict_mode": false, "quiet": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_nested_cumulative_type_params": false, "send_anonymous_usage_stats": true, "use_colors": true, "version_check": true, "show_resource_report": false, "vars": {}, "partial_parse": true, "project_dir": "C:\\Projects\\DBT\\bank-analytics\\-ESG-Risk-Intelligence-Platform", "introspect": true, "populate_cache": true, "select": []}}